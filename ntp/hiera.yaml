# managed by puppet
---
 version: 5
 defaults:
  datadir: data
  data_hash: yaml_data

 hierarchy:
- name: "Nodes"
   backend: yaml
    paths: 
      - "nodes/%{::trusted.certname}"
      - "%{environment}/%{calling_modules}"
      - "%{environment}/%{calling_class}"
      - "%{environment}/%{role}"
      - "%{role}"
      - "%{role}/%{::profile}"
      - "%{profile}"
      - "%{environment}"
      - "%{fqdn}"

- name: "Exported JSON nodess"
   backend: json
    paths:  
      - "nodes/%{::trusted.certname}"
      - "insecure_nodess/%{facts.fqdn}"


- name: "Eysml ( encryption )
   backend: eyaml
    paths:
      - "nodes/%{::trusted.certname}"
      - "%{environment}/%{calling_modules}"
      - "%{environment}/%{calling_class}"
      - "%{environment}/%{role}"
      - "%{role}"
      - "%{role}/%{::profile}"
      - "%{profile}"
      - "%{environment}"
      - "%{fqdn}"

     :pkcs7_private_key: /etc/puppetlabs/code/environments/%(environment)/hieradata/secure/keys/private_key.pkcs7.pem

     :pkcs7_public_key: /etc/puppetlabs/code/environments/%(environment)/hieradata/secure/keys/public_key.pkcs7.pem

        name: "global"
        backend: yaml

        name: "secure"
        backend: yaml

        name" "common" 
        backend: yaml
